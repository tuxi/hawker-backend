server {
    listen 80;
    server_name 43.156.94.29;

    # 1. é™æ€éŸ³é¢‘èµ„æº
    location /static/ {
        alias /app/static/;
        add_header Access-Control-Allow-Origin *;
    }

    # 2. æ ¸å¿ƒï¼šå¤„ç†æ‰€æœ‰ API å’Œ WebSocket è¯·æ±‚
    location /api/v1/ {
        proxy_pass http://hawker-backend:12188; # æŒ‡å‘ Go åç«¯å®¹å™¨

        # åŸºç¡€ Proxy å¤´ä¿¡æ¯
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;

        # ğŸŒŸ å…³é”®ï¼šWebSocket æ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";

        # é’ˆå¯¹ WS çš„è¶…æ—¶ä¼˜åŒ–ï¼ˆå»ºè®®è®¾ä¸º 1 å°æ—¶ï¼Œç”± Go åç«¯é€šè¿‡å¿ƒè·³æ§åˆ¶æ–­å¼€ï¼‰
        proxy_read_timeout 3600s;
        proxy_send_timeout 3600s;

        # ç¦ç”¨ç¼“å­˜ï¼Œç¡®ä¿å®æ—¶æ€§
        proxy_buffering off;
    }
}