services:
  # Nginx æœåŠ¡
  nginx:
    image: nginx:alpine
    container_name: hawker-nginx
    ports:
      - "80:80"   # æ˜ å°„ HTTP ç«¯å£
      # - "443:443" # å¦‚æœæœ‰ SSLï¼Œå¼€å¯æ­¤ç«¯å£
    volumes:
      - ./nginx/hawker.conf:/etc/nginx/conf.d/default.conf:ro
      - ./static:/app/static:ro # ğŸŒŸ å…³é”®ï¼šè®© Nginx ä¹Ÿèƒ½è¯»å–éŸ³é¢‘æ–‡ä»¶ç›®å½•
      - ./logs/nginx:/var/log/nginx
    depends_on:
      - hawker-app
    networks:
      - hawker-net
  #åç«¯æœåŠ¡
  hawker-app:
    # ğŸŒŸ å…³é”®ï¼šå‘Šè¯‰ compose ä»å½“å‰ç›®å½•æ„å»ºé•œåƒ
    build: .
    image: hawker-backend:latest
    container_name: hawker-backend
    # ports:
    #   - "12188:12188" # å±è”½å¤–éƒ¨ç›´æ¥è®¿é—®ï¼Œåªé€šè¿‡ Nginx è®¿é—®
    volumes:
      - ./conf:/app/hawker-backend/conf
      - ./logs:/app/hawker-backend/logs
      - ./static:/app/hawker-backend/static
    restart: always
    networks:
      - hawker-net
    environment:
      # å¦‚æœæ˜¯åŒæœºéƒ¨ç½²ï¼Œå°½é‡æ¢æˆå†…ç½‘ IP
      DB_HOST: ""
      DB_PORT: 5432
      DB_USER: postgres
      DB_PASSWORD: "" # å»ºè®®ç”¨å¼•å·åŒ…è£¹ï¼Œé˜²æ­¢ç‰¹æ®Šå­—ç¬¦è§£æé”™è¯¯
      DB_NAME: hawker_db
      TEST: ""

networks:
  hawker-net:
    driver: bridge